<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>La Taverne de Limoges</title>

    <!-- ✅ React + ReactDOM depuis CDN -->
    <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>

    <!-- ✅ Lucide React Icons depuis CDN -->
    <script src="https://unpkg.com/lucide-react@latest/dist/umd/lucide-react.min.js"></script>

    <!-- ✅ Tailwind via CDN -->
    <script src="https://cdn.tailwindcss.com"></script>

    <style>
      body {
        margin: 0;
        font-family: system-ui, sans-serif;
        background-color: #1a1410;
        color: #fff;
      }
    </style>
  </head>

  <body>
    <div id="root"></div>

    <script type="text/javascript">
      const { useState } = React;
      const { ShoppingCart, ChevronLeft, Sparkles, Coins, Gem, Crown, Scroll } = lucideReact;

      const TelegramShopApp = () => {
        const [currentView, setCurrentView] = useState('home');
        const [selectedCategory, setSelectedCategory] = useState(null);
        const [selectedProduct, setSelectedProduct] = useState(null);
        const [selectedQuantity, setSelectedQuantity] = useState(null);

        const TELEGRAM_USERNAME = 'Aladin_870';

        const categories = [
          { id: 'weed', name: 'Weed', emoji: '🌿' },
          { id: 'mousse', name: 'Mousse', emoji: '💨' },
          { id: 'frozen', name: 'Frozen', emoji: '❄️' },
          { id: 'filtrer', name: 'Filtrer', emoji: '🔥' }
        ];

        const quantityOptions = {
          weed: [
            { amount: 1.4, price: 10, label: '1.4g' },
            { amount: 2.8, price: 20, label: '2.8g' },
            { amount: 4.5, price: 30, label: '4.5g' },
            { amount: 11, price: 70, label: '11g' },
            { amount: 25, price: 150, label: '25g' },
            { amount: 50, price: 240, label: '50g' },
            { amount: 100, price: 450, label: '100g', treasure: true }
          ],
          mousse: [
            { amount: 2.3, price: 10, label: '2.3g' },
            { amount: 4.6, price: 20, label: '4.6g' },
            { amount: 10, price: 50, label: '10g' },
            { amount: 25, price: 110, label: '25g' },
            { amount: 50, price: 200, label: '50g' },
            { amount: 100, price: 350, label: '100g', treasure: true }
          ],
          frozen: [
            { amount: 0.5, price: 30, label: '0.5g' },
            { amount: 1, price: 50, label: '1g' },
            { amount: 2, price: 100, label: '2g' },
            { amount: 5, price: 250, label: '5g', treasure: true },
            { amount: 10, price: 450, label: '10g' }
          ],
          filtrer: [
            { amount: 1, price: 25, label: '1g' },
            { amount: 3, price: 70, label: '3g' },
            { amount: 5, price: 110, label: '5g' },
            { amount: 10, price: 200, label: '10g', treasure: true }
          ]
        };

        const products = {
          frozen: [
            { id: 1, name: 'Frozen Premium', description: 'White💎 - Pureté légendaire', video: 'https://www.w3schools.com/html/mov_bbb.mp4', badge: '💎 Rare' }
          ],
          mousse: [
            { id: 4, name: 'Jaune Mousseux', description: 'Jaune Mousseux - Texture mystique', video: 'https://www.w3schools.com/html/mov_bbb.mp4', badge: '⭐ Défonce+' }
          ],
          weed: [
            { id: 5, name: 'Weed Premium', description: 'Weed Premium - Trésor ancestral', video: 'https://www.w3schools.com/html/mov_bbb.mp4', badge: '👑 Quality++' }
          ],
          filtrer: [
            { id: 6, name: 'Filtrer Premium', description: 'Filtrer - Qualité suprême', video: 'https://www.w3schools.com/html/mov_bbb.mp4', badge: '🔥 Défonce++' }
          ]
        };

        const handleCategoryClick = (categoryId) => {
          setSelectedCategory(categoryId);
          const categoryProducts = products[categoryId] || [];
          if (categoryProducts.length > 0) {
            setSelectedProduct(categoryProducts[0]);
            setSelectedQuantity(null);
            setCurrentView('product-detail');
          }
        };

        const handleOrder = () => {
          if (!selectedQuantity) return;

          const message = `🏺 *NOUVELLE COMMANDE*\n\n` +
            `💎 Produit: ${selectedProduct.name}\n` +
            `⚖️ Quantité: ${selectedQuantity.label}\n` +
            `💰 Prix: ${selectedQuantity.price}€\n\n` +
            `Que la fortune vous accompagne !`;

          const encodedMessage = encodeURIComponent(message);
          const telegramUrl = `https://t.me/${TELEGRAM_USERNAME}?text=${encodedMessage}`;
          navigator.clipboard.writeText(message).then(() => {
            window.open(telegramUrl, '_blank');
          });
        };

        const renderHome = () => (
          React.createElement("div", { className: "min-h-screen flex items-center justify-center bg-gradient-to-b from-stone-900 to-amber-900 text-amber-100" },
            React.createElement("div", { className: "text-center space-y-4" },
              React.createElement("h1", { className: "text-2xl font-bold mb-4" }, "La Taverne de Limoges"),
              React.createElement("div", { className: "grid grid-cols-2 gap-3" },
                categories.map((cat) =>
                  React.createElement("button", {
                    key: cat.id,
                    onClick: () => handleCategoryClick(cat.id),
                    className: "p-4 bg-amber-700/40 rounded-xl hover:bg-amber-600/60 transition"
                  },
                    React.createElement("div", { className: "text-3xl" }, cat.emoji),
                    React.createElement("div", null, cat.name)
                  )
                )
              )
            )
          )
        );

        const renderProductDetail = () => (
          React.createElement("div", { className: "min-h-screen p-4 bg-gradient-to-b from-stone-900 to-amber-900 text-amber-100" },
            React.createElement("button", { onClick: () => setCurrentView('home'), className: "mb-4 flex items-center gap-2 text-sm" },
              React.createElement(ChevronLeft, null), " Retour"
            ),
            React.createElement("div", { className: "space-y-4 text-center" },
              React.createElement("h2", { className: "text-xl font-bold" }, selectedProduct?.name),
              React.createElement("video", { className: "mx-auto rounded-lg w-full max-w-md", controls: true },
                React.createElement("source", { src: selectedProduct?.video, type: "video/mp4" })
              ),
              React.createElement("p", null, selectedProduct?.description),
              React.createElement("div", { className: "grid grid-cols-2 gap-2 max-w-md mx-auto" },
                (quantityOptions[selectedCategory] || []).map((opt) =>
                  React.createElement("button", {
                    key: opt.label,
                    onClick: () => setSelectedQuantity(opt),
                    className: `p-3 rounded-lg border ${selectedQuantity?.amount === opt.amount ? 'bg-amber-600' : 'bg-stone-800'}`
                  },
                    `${opt.label} — ${opt.price}€`
                  )
                )
              ),
              selectedQuantity && React.createElement("button", {
                onClick: handleOrder,
                className: "bg-yellow-500 text-stone-900 font-bold py-3 px-6 rounded-lg mt-4"
              }, `Commander ${selectedQuantity.label}`)
            )
          )
        );

        return currentView === 'home' ? renderHome() : renderProductDetail();
      };

      ReactDOM.createRoot(document.getElementById('root')).render(React.createElement(TelegramShopApp));
    </script>
  </body>
</html>
